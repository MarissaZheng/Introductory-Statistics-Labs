---
title: "Lab 2: College Basketball"
output: learnr::tutorial
tutorial:
  id: "Lab 2"
  version: 1.0
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = FALSE)
bball = read.csv("https://raw.githubusercontent.com/kbodwin/ShinyLabs/master/Datasets/bball.csv")
bball = bball[,-1]
source("https://raw.githubusercontent.com/kbodwin/ShinyLabs/master/Scripts/makeStrings.R")
library(tidyverse)
```

## The Data

Today we will be looking at a dataset of college basketball games from 2015-16.  The data is already loaded for you into a dataset called `bball`.  Recall Lab 1, and use the code box below to take a look at what is going on in `bball`.

```{r ex_1, exercise = TRUE}
```

### Summarizing the dataset


Describe this dataset using vocabulary from Stats 218. Pay particular attention to what is going on with the variable `Team.Location`; notice that each game is listed twice, once for each team.

```{r q_1}
textAreaInput("a_1.1",
           "",
           value = "",
           width = '80%', placeholder = NULL)
```

## Subsetting

An important skill in **R** is to make new datasets, consisting of only the information we care about from the original data.  We will do this by piping (`%>%`) our dataset `bball` into a function called `filter()`, and then saving the results.

Read the code below, and try to guess what it is doing.  Then run it.

```{r ex_2, exercise = TRUE}
ucla <- bball %>% filter(Team == "UCLA")
summary(ucla)
```

```{r q_2}
textAreaInput("a_2.1",
           "What did this code do?",
           value = "",
           width = '80%', placeholder = NULL)

textInput("a_2.2",
           "How many points did UCLA score, on average, in 2015-16?",
           value = "",
           width = '80%', placeholder = NULL)


textInput("a_2.3",
           "How games did UCLA win in 2015-16?",
           value = "",
           width = '80%', placeholder = NULL)
```

We give **R** more than one condition to filter by.  For example, adjust the following code to show only the game where UCLA played against USC (aka "Southern California").

```{r ex_2.4, exercise = TRUE}
bball %>% filter(Team == "UCLA", Opponent == "")
```

```{r q_2.4}
textAreaInput("a_2.4",
           "What happened in these games?",
           value = "",
           width = '80%', placeholder = NULL)
```

## Wins and Losses

Use the code box below to answer the following questions.

```{r ex_5, exercise = TRUE}

```

```{r q_5}
textInput("a_5.1",
           "How many games did Cal Poly play in 2015-16?",
           value = "",
           width = '80%', placeholder = NULL)

textInput("a_5.2",
           "How many games did Cal Poly win in 2015-16?",
           value = "",
           width = '80%', placeholder = NULL)

```

Now think about quantifying evidence. Use your Binomial probability skills to answer the following.

```{r ex_6, exercise = TRUE}

```

```{r q_6}
textAreaInput("a_6.1",
           "Was Cal Poly a below average team in 2015-16?  Justify your answer.",
           value = "",
           width = '80%', placeholder = NULL)

```

## Normal Probabilities

In the following code box, use your skills from Lab 1 to make a histogram of the number of points a team scores in a given game.

```{r ex_7, exercise = TRUE}
```


```{r q_7}
textAreaInput("a_6.1",
           "Do you think that the random variable 'Points scored by a college basketball team' is Normal?  Why or why not?",
           value = "",
           width = '80%', placeholder = NULL)

```

Suppose we assume that the number of points scored *is* Normal.  We can calculate the mean and standard deviation of **all** the games in 2015-16, and assume that these are good guesses about the *parameters* $\mu$ and $\sigma$.

```{r, echo = TRUE}
bball %>% summarize_at(vars(Team.Score), funs(mean, sd))
```

### Analyzing a game.

On January 16, 2016,  UC Santa Barbara lost to UC Irvine.  Ha.  Those losers. Use the code box to answer the following.

```{r ex_8, exercise = TRUE}
```


```{r q_8}
textInput("a_8.0",
           "How many points did UCSB score on January 16th?",
           value = "",
           width = '80%', placeholder = NULL)


textInput("a_8.1",
           "How many times in 2015-16 did a team score fewer points than UCSB did on January 16th?",
           value = "",
           width = '80%', placeholder = NULL)

textInput("a_8.2",
           "What percent of the time did a team score fewer points than UCSB did on January 16th?",
           value = "",
           width = '80%', placeholder = NULL)

```

Now suppose that points scored is perfectly Normal, with the mean and standard deviation that we calculated above. 

```{r ex_9, exercise = TRUE}
```


```{r q_9}
textInput("a_9.1",
           "What percent of the time do you expect a team to score more than UCSB did on January 16th?",
           value = "",
           width = '80%', placeholder = NULL)

textAreaInput("a_8.2",
           "How does this compare to the actual percent of times a team scored more?  What does this tell you about whether or not points scored is a Normal random variable?",
           value = "",
           width = '80%', placeholder = NULL)

```

## YOUR TURN

Many sports fans believe that teams tend to play better when they are in their home arena, perhaps because they are more comfortable there or because they are energized by their fans.  This idea is called "Home Court Advantage".

In the `bball` dataset, there is a variable called `Team.Location` that tells whether the first team listed is playing at `Home`, `Away`, or at a `Neutral` location.

Using this dataset, do you think there is any evidence of Home Court Advantage?  Be creative - think about different ways you might measure if a team is playing "better" at home.  For example, how could you use this dataset to check if the Home team won more often than the Away team?

Write up your answer - including any plots you might like to create - in a way that would be understandable and interesting to someone outside this class.

```{r ex_10, exercise = TRUE}
```


```{r q_10}

textAreaInput("a_8.2",
           "Write your analysis here.",
           value = "",
           width = '80%', placeholder = NULL)

```


Choose `File > Print` and save the output as a pdf.  Upload this page only to PolyLearn.
